<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Cheeky Commodore Gamer | Retro Gaming Hub</title>
    <meta name="description" content="Dive into the world of retro gaming! Search the full index of Commodore 64 and Amiga games.">
    <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
    <link href="https://db.onlinewebfonts.com/c/05eb10077a913e99089a693039e6273e?family=Amiga+Topaz" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <link rel="stylesheet" href="./css/style.css">

    <style>
        /* Page-Specific Overrides */
        body { overflow-x: hidden; }
        #start-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: #000; z-index: 6000; display: flex; flex-direction: column; justify-content: center; align-items: center; cursor: pointer; }
        .power-text { color: var(--c64-text); font-size: 2.5rem; font-family: 'VT323', monospace; animation: blink 1s infinite; margin-top: 20px; }
        
        #loading-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: var(--c64-blue); z-index: 5000; display: none; flex-direction: column; justify-content: flex-start; padding: 40px; font-family: 'VT323', monospace; font-size: 1.5rem; color: var(--c64-light-blue); cursor: none; }
        
        .search-wrapper { margin: 30px 0; position: relative; max-width: 800px; margin-left: auto; margin-right: auto; }
        .search-input { width: 100%; padding: 15px; font-size: 1.5rem; text-transform: uppercase; border: 3px solid; background: rgba(0,0,0,0.2); outline: none; }
        
        /* Mode Colors for Search */
        body.c64-mode .search-input { color: var(--c64-text); border-color: var(--c64-light-blue); font-family: 'VT323', monospace; }
        body.amiga-mode .search-input { color: var(--amiga-black); border-color: var(--amiga-blue); font-family: 'Amiga Topaz', monospace; background: #fff; }

        .monitor-wrapper { background: #111; border: 15px solid #333; border-radius: 20px; padding: 20px; margin: 40px auto; max-width: 900px; box-shadow: 0 0 30px rgba(0,0,0,0.8); }
        .monitor-screen { position: relative; padding-bottom: 56.25%; height: 0; background: #000; overflow: hidden; border-radius: 10px; }
        .monitor-screen iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: 0; }
        
        .btn-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .btn-retro { padding: 20px; font-size: 1.5rem; text-transform: uppercase; text-align: center; border: 3px solid; cursor: pointer; text-decoration: none; display: block; font-weight: bold; transition: transform 0.1s; }
        
        body.c64-mode .btn-retro { background: var(--c64-light-blue); color: #fff; border-color: #fff; font-family: 'VT323', monospace; }
        body.c64-mode .btn-retro:hover { background: #fff; color: var(--c64-blue); }
        
        body.amiga-mode .btn-retro { background: #eee; color: #000; border-color: #aaa; font-family: 'Amiga Topaz', monospace; border-style: outset; }
        body.amiga-mode .btn-retro:active { border-style: inset; }

        .stats-box { margin-top: 50px; padding-top: 20px; border-top: 2px dashed; text-align: center; font-size: 1.5rem; display: flex; justify-content: center; gap: 40px; }
        body.c64-mode .stats-box { border-color: var(--c64-light-blue); color: var(--c64-cyan); }
        body.amiga-mode .stats-box { border-color: var(--amiga-blue); color: var(--amiga-blue); }

        @keyframes blink { 50% { opacity: 0; } }
        #main-container { display: none; } /* Hidden until "Power On" */
    </style>
</head>
<body class="c64-mode"> 
    
    <div id="start-screen" onclick="startSystem()">
        <img src="https://raw.githubusercontent.com/joepentony-dot/website-images/main/CCGAMER%20LOGO.png" alt="Logo" style="max-width: 300px; width: 80%;">
        <div class="power-text">CLICK TO POWER ON</div>
    </div>

    <div id="loading-screen">
        <div style="position: absolute; top: 20px; right: 20px; border: 2px solid #fff; padding: 10px; cursor: pointer;" onclick="skipLoading()">[ESC] SKIP</div>
        <div style="margin-top: 100px;">
            <span id="loading-terminal"></span><span style="animation:blink 1s infinite;">&#9608;</span>
        </div>
    </div>

    <div id="global-header-container"></div>

    <div class="container" id="main-container">
        
        <div style="text-align: center; margin-bottom: 40px; min-height: 80px;">
            <h1 id="typewriter-text" style="font-size: 3rem; margin-bottom: 10px;"></h1>
            <p id="ready-prompt" style="color: var(--c64-light-blue); font-size: 1.5rem; display:none;">READY.</p>
        </div>

        <div class="search-wrapper">
            <input type="text" class="search-input" id="homeSearch" placeholder="SEARCH DATABASE..." autocomplete="off">
            <div class="search-results" id="homeSearchResults"></div>
        </div>

        <h2 style="text-align: center; margin-top: 40px;">GAME OF THE MOMENT</h2>
        <div class="monitor-wrapper">
            <div class="monitor-screen" id="spotlightVideo">
                <div style="position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); color:#fff;">LOADING SIGNAL...</div>
            </div>
        </div>

        <h2 style="text-align: center; margin-top: 40px;">QUICK ACCESS</h2>
        <div class="btn-grid">
            <a href="./games/index.html" class="btn-retro play-sound">BROWSE GENRES</a>
            <a href="./resources/quiz.html" class="btn-retro play-sound">RETRO QUIZ</a>
            <a href="./resources/emulation-guide.html" class="btn-retro play-sound">EMULATION HELP</a>
        </div>

        <div class="stats-box">
            <span id="visitorCount">VISITORS: ...</span>
            <span>|</span>
            <span id="gamesCount">GAMES: ...</span>
        </div>
    </div>

    <script src="./js/global.js"></script>
    
    <script>
        // --- QUICK LOADING LOGIC ---
        const API_KEY = "AIzaSyABtgqVHmOrfzw2DLE-3ta3OmlaQ0ad_t8"; 
        const C64_LIST = "PL_TYjnCNYSex7dxxCMMuOsjzcXE1VNiR9";
        const AMIGA_LIST = "PL_TYjnCNYSezw55SVAMN2_UhdH3gCca1n";
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwhkSGA6HcSvCljqBA91JmQVsVVUPU5LCEO1HlifB_Cjwc0DTFCK3m6hG5ZFDSgVHw9/exec';
        let loadingAborted = false;

        function startSystem() {
            document.getElementById('start-screen').style.display = 'none';
            document.getElementById('loading-screen').style.display = 'flex';
            loadSequence();
            fetchData();
        }

        function skipLoading() {
            loadingAborted = true;
            finishLoading();
        }

        async function loadSequence() {
            const term = document.getElementById('loading-terminal');
            const text = 'LOAD "*",8,1... SEARCHING FOR CHEEKY GAMER... LOADING...';
            let i = 0;
            const t = setInterval(() => {
                if (loadingAborted) { clearInterval(t); finishLoading(); return; }
                term.innerText += text.charAt(i);
                i++;
                if (i >= text.length) { clearInterval(t); setTimeout(finishLoading, 1000); }
            }, 50);
        }

        function finishLoading() {
            document.getElementById('loading-screen').style.display = 'none';
            document.getElementById('main-container').style.display = 'block';
            // Typewriter Title
            const title = "COMMODORE 64 & AMIGA DATABASE";
            let j = 0;
            const h1 = document.getElementById("typewriter-text");
            h1.innerHTML = "";
            const t2 = setInterval(() => {
                h1.innerHTML += title.charAt(j);
                j++;
                if(j >= title.length) { clearInterval(t2); document.getElementById('ready-prompt').style.display = 'block'; }
            }, 50);
        }

        async function fetchData() {
            // Fetch Stats
            fetch(`${SCRIPT_URL}?action=trackVisitor`, {method:'POST'}).catch(()=>{});
            fetch(`${SCRIPT_URL}?getCounters=true`).then(r=>r.json()).then(data => {
                if(data.visitors) document.getElementById('visitorCount').textContent = `VISITORS: ${data.visitors}`;
            });

            // Fetch Video
            try {
                const res = await fetch(`https://www.googleapis.com/youtube/v3/playlistItems?part=snippet&maxResults=50&playlistId=${C64_LIST}&key=${API_KEY}`);
                const data = await res.json();
                if(data.items && data.items.length > 0) {
                    const rnd = data.items[Math.floor(Math.random() * data.items.length)];
                    document.getElementById('spotlightVideo').innerHTML = 
                        `<iframe src="https://www.youtube.com/embed/${rnd.snippet.resourceId.videoId}?autoplay=1&mute=1" allowfullscreen></iframe>`;
                    document.getElementById('gamesCount').textContent = "GAMES: 500+";
                }
            } catch(e) { console.log(e); }
        }
    </script>
</body>
</html>
