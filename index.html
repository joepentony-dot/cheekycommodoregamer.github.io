<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cheeky Commodore Gamer | Main Menu</title>
    <meta name="description" content="Dive into the world of retro gaming evolved! Search the full index of Commodore 64 and Amiga games. Watch videos, take the retro quiz, and relive the 8-bit era.">
    
    <link rel="canonical" href="https://www.cheekycommodoregamer.co.uk/">
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

    <meta property="og:title" content="Cheeky Commodore Gamer | The Ultimate C64 & Amiga Retro Gaming Hub">
    <meta property="og:description" content="Search the massive index of Commodore 64 and Amiga videos, take the retro quiz, and browse game genres. Relive the 8-bit and 16-bit era!">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.cheekycommodoregamer.co.uk/">
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=VT323&display=swap');
        @import url('https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css');

        :root {
            --c64-blue: #352879;
            --c64-light-blue: #6c5eb5;
            --c64-text: #b8c76f;
            --c64-red: #880000;
            --c64-green: #55cc55;
            --c64-cyan: #00ffff;
            --c64-yellow: #feff6c;
            --c64-purple: #cc44cc;
            --c64-white: #ffffff;
            --c64-black: #000000;
            --c64-orange: #d55e00; 
            --c64-brown: #664400;
        }

        * { box-sizing: border-box; }

        body {
            background-color: var(--c64-blue);
            color: var(--c64-text);
            font-family: 'VT323', monospace;
            margin: 0;
            padding: 10px;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: flex-start; 
            text-transform: uppercase;
            overflow-x: hidden;
        }

        /* --- STARFIELD CANVAS --- */
        #starfield {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: -1;
            opacity: 0.3;
        }

        /* --- CRT EFFECT --- */
        .crt-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
            background-size: 100% 2px, 3px 100%;
            pointer-events: none;
            z-index: 9999;
        }

        /* --- START SCREEN --- */
        #start-screen {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background-color: #000;
            z-index: 6000;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
            cursor: pointer;
            padding-top: 3vh; /* MOVED HIGHER: Changed from 10vh to 3vh */
        }
        .power-text {
            color: var(--c64-text);
            font-size: 2.5rem;
            animation: blink 1s infinite;
            text-align: center;
            padding: 0 20px;
        }

        /* --- LOADING SCREEN --- */
        #loading-screen {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background-color: var(--c64-blue);
            z-index: 5000;
            display: none;
            flex-direction: column;
            justify-content: flex-start;
            padding: 40px;
            font-size: 1.5rem;
            color: var(--c64-light-blue);
            /* FIX: Use default cursor to ensure mouse pointer is always visible on this screen */
            cursor: default !important;
        }

        /* --- SKIP BUTTON --- */
        #skip-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 6002;
            background: var(--c64-red);
            color: #fff;
            border: 2px solid #fff;
            padding: 10px 20px;
            font-family: 'VT323', monospace;
            font-size: 1.5rem;
            cursor: pointer;
            text-transform: uppercase;
            box-shadow: 4px 4px 0px #000;
            pointer-events: auto;
        }
        #skip-btn:hover {
            background: #fff;
            color: var(--c64-red);
        }

        /* --- RASTER BARS (BLURRED) --- */
        .raster-bars {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: 5001;
            background: linear-gradient(to bottom,
                var(--c64-black) 0%, var(--c64-black) 10%,
                var(--c64-white) 10%, var(--c64-white) 20%,
                var(--c64-red) 20%, var(--c64-red) 30%,
                var(--c64-cyan) 30%, var(--c64-cyan) 40%,
                var(--c64-purple) 40%, var(--c64-purple) 50%,
                var(--c64-green) 50%, var(--c64-green) 60%,
                var(--c64-blue) 60%, var(--c64-blue) 70%,
                var(--c64-yellow) 70%, var(--c64-yellow) 80%,
                var(--c64-orange) 80%, var(--c64-orange) 90%,
                var(--c64-brown) 90%, var(--c64-brown) 100%
            );
            background-size: 100% 400px; 
            animation: rasterScroll 2.5s linear infinite; 
            opacity: 0.9;
            display: none;
            pointer-events: none;
            filter: blur(4px);
        }

        @keyframes rasterScroll {
            0% { background-position: 0 0; }
            100% { background-position: 0 400px; }
        }

        .loading-text-wrapper {
            position: relative;
            z-index: 5002;
            padding-top: 60px;
        }

        .text-highlight {
            background-color: var(--c64-blue);
            color: var(--c64-light-blue);
            padding: 2px 8px;
            display: inline-block;
            box-shadow: 4px 4px 0px rgba(0,0,0,0.5);
            margin-bottom: 5px;
        }

        /* --- MAIN CONTAINER --- */
        .container {
            width: 100%;
            max-width: 900px;
            border: 4px solid var(--c64-light-blue);
            background-color: rgba(53, 40, 121, 0.95);
            padding: 15px;
            position: relative;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
            margin-top: 10px;
            margin-bottom: 60px;
            margin-left: auto; margin-right: auto;
            display: none; 
        }

        /* --- TYPOGRAPHY --- */
        h1 { font-size: 2rem; color: #fff; margin: 0 0 10px 0; text-align: center; font-weight: normal; }
        h2 { font-size: 1.5rem; color: var(--c64-cyan); margin: 20px 0 10px 0; text-align: center; font-weight: normal; text-shadow: 0 0 5px var(--c64-cyan); }
        h3 { margin: 0 0 10px 0; text-align: center; font-weight: normal; font-size: 1.2rem; }
        p { font-size: 1.2rem; margin-bottom: 15px; text-align: center; line-height: 1.4; }
        a { color: #fff; text-decoration: none; }

        .cursor {
            display: inline-block;
            width: 12px;
            height: 1.1em;
            background-color: var(--c64-light-blue);
            animation: blink 0.8s infinite;
            vertical-align: bottom;
            margin-left: 2px;
        }
        
        /* FIX: Ensure loading cursor is visible over dark background */
        .loading-cursor {
            display: inline-block !important; /* Force display */
        }
        
        .commodore-header { text-align: center; margin-bottom: 20px; border-bottom: 2px dashed var(--c64-light-blue); padding-bottom: 10px; }
        .nav-bar { display: flex; justify-content: center; flex-wrap: wrap; gap: 15px; margin-bottom: 15px; border-bottom: 2px solid var(--c64-light-blue); padding-bottom: 15px; }
        .nav-link { font-size: 1.2rem; color: var(--c64-text); cursor: pointer; white-space: nowrap; }
        .nav-link:hover { color: #fff; text-decoration: underline; }

        .monitor-wrapper { background: #000; border: 4px solid #444; border-radius: 10px; padding: 10px; margin: 20px auto; max-width: 600px; box-shadow: 0 0 15px rgba(0,255,255,0.2); }
        .monitor-screen { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; background: #000; }
        .monitor-screen iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: 0; }
        .monitor-label { text-align: center; color: #888; font-size: 0.9rem; margin-top: 5px; }

        .btn-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-bottom: 25px; width: 100%; }
        .btn-retro { background: var(--c64-light-blue); color: #fff; border: 2px solid #fff; padding: 15px 20px; font-family: 'VT323', monospace; font-size: 1.4rem; cursor: pointer; display: flex; justify-content: center; align-items: center; gap: 10px; text-align: center; transition: all 0.1s; text-transform: uppercase; width: 100%; }
        .btn-retro:hover { background: #fff; color: var(--c64-blue); }
        .btn-retro:active { transform: translateY(2px); }
        
        .btn-emphasise { border-color: var(--c64-cyan) !important; color: var(--c64-cyan) !important; text-shadow: 0 0 8px var(--c64-cyan); box-shadow: 0 0 10px rgba(0, 255, 255, 0.5), 0 0 5px rgba(0, 255, 255, 0.8); animation: glow-pulse 2s infinite alternate; }
        .btn-emphasise:hover { background: var(--c64-cyan) !important; color: var(--c64-blue) !important; text-shadow: none; box-shadow: none; }
        
        @keyframes glow-pulse { 0% { box-shadow: 0 0 8px rgba(0, 255, 255, 0.5); } 100% { box-shadow: 0 0 15px rgba(0, 255, 255, 1), 0 0 5px rgba(0, 255, 255, 0.8); } }

        .search-wrapper { margin-bottom: 25px; position: relative; }
        .search-input { width: 100%; background: #000; color: var(--c64-text); border: 2px solid var(--c64-light-blue); padding: 12px; font-family: 'VT323', monospace; font-size: 1.4rem; text-transform: uppercase; outline: none; }
        .search-input:focus { border-color: #fff; }
        .search-input::placeholder { color: var(--c64-light-blue); opacity: 0.7; }
        .search-results { display: none; background: #000; border: 2px solid var(--c64-light-blue); border-top: none; max-height: 300px; overflow-y: auto; width: 100%; position: absolute; z-index: 100; }
        .search-results.active { display: block; }
        .result-item { display: flex; justify-content: space-between; padding: 10px; border-bottom: 1px dashed #333; color: #fff; cursor: pointer; font-size: 1.2rem; }
        .result-item:hover { background: var(--c64-light-blue); }
        .result-badge { color: var(--c64-text); font-size: 0.9rem; }

        .stats-box { display: flex; justify-content: center; gap: 20px; margin-top: 20px; font-size: 1.3rem; color: var(--c64-cyan); text-shadow: 0 0 5px var(--c64-cyan); font-weight: bold; flex-wrap: wrap; border-top: 1px dashed var(--c64-light-blue); padding-top: 15px; }

        .marquee-container { position: fixed; bottom: 0; left: 0; width: 100%; background: var(--c64-light-blue); color: #fff; padding: 5px 0; border-top: 2px solid #fff; z-index: 100; overflow: hidden; white-space: nowrap; display: none; }
        .marquee-content { display: inline-block; padding-left: 100%; animation: marquee 20s linear infinite; font-size: 1.2rem; }
        @keyframes marquee { 0% { transform: translate(0, 0); } 100% { transform: translate(-100%, 0); } }

        .blink { animation: blink 1s infinite; }
        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0; } }

        @media (max-width: 600px) {
            body { padding: 0; }
            .container { padding: 10px 5px; margin-top: 5px; width: 100%; border-width: 2px; box-sizing: border-box; }
            .nav-bar { display: grid; grid-template-columns: repeat(3, 1fr); gap: 5px; justify-items: center; }
            .nav-link { font-size: 1.1rem; padding: 5px; }
            .btn-grid { grid-template-columns: 1fr; gap: 12px; }
            h1 { font-size: 1.8rem; }
            #start-screen { padding-top: 10px; } /* MOVED HIGHER: Changed from 10vh to 10px */
            #loading-screen { padding: 20px; font-size: 1.2rem; }
            #skip-btn { top: 5px; right: 5px; font-size: 1.2rem; padding: 8px 12px; }
        }

        ::-webkit-scrollbar { width: 10px; }
        ::-webkit-scrollbar-track { background: var(--c64-blue); }
        ::-webkit-scrollbar-thumb { background: var(--c64-light-blue); border: 1px solid #fff; }

    </style>
</head>
<body>

    <canvas id="starfield"></canvas>
    <div class="crt-overlay"></div>

    <div id="start-screen" onclick="startSystem()">
        <div class="commodore-header" style="border:none; margin-bottom: 20px;">
             <img src="https://raw.githubusercontent.com/joepentony-dot/website-images/main/CCGAMER%20LOGO.png" alt="Logo" style="max-width: 150px; image-rendering: pixelated;">
        </div>
        <div class="power-text">CLICK TO POWER ON</div>
    </div>

    <div id="loading-screen">
        <button id="skip-btn" onclick="skipLoading()">[ ESC ] SKIP LOAD</button>
        <div class="raster-bars" id="rasterBars"></div>
        <div class="loading-text-wrapper">
            <span id="loading-terminal"></span><span class="cursor loading-cursor" id="loading-cursor"></span>
        </div>
    </div>

    <div class="container" id="main-container">
        <div class="commodore-header">
            <img src="https://raw.githubusercontent.com/joepentony-dot/website-images/main/CCGAMER%20LOGO.png" alt="Cheeky Commodore Gamer Logo - Retro Gaming Hub" style="max-width: 150px; image-rendering: pixelated; margin-bottom: 10px;">
            <h3>**** COMMODORE 64 BASIC V2 ****</h3>
            <p>64K RAM SYSTEM 38911 BASIC BYTES FREE</p>
            <div class="nav-bar">
                <a href="/cheekycommodoregamer.github.io/games" class="nav-link play-sound">GENRES</a>
                <a href="/cheekycommodoregamer.github.io/games/complete-index.html" class="nav-link play-sound">INDEX</a>
                <a href="/cheekycommodoregamer.github.io/resources/quiz.html" class="nav-link play-sound">QUIZ</a>
                <a href="/cheekycommodoregamer.github.io/retro-events.html" class="nav-link play-sound">EVENTS</a>
                <a href="/cheekycommodoregamer.github.io/about.html" class="nav-link play-sound">ABOUT</a>
                <a href="/cheekycommodoregamer.github.io/contact.html" class="nav-link play-sound">CONTACT</a>
            </div>
        </div>

        <div style="text-align: center; margin-bottom: 30px; min-height: 80px;">
            <h1 id="typewriter-text"></h1>
            <p id="typewriter-sub" style="color: var(--c64-light-blue);">READY.<span class="cursor"></span></p>
        </div>
        
        <h2>COMMAND LINE: SEARCH C64 AND AMIGA TITLES</h2>

        <div class="search-wrapper">
            <input type="text" class="search-input" id="homeSearch" placeholder="INITIALIZING TAPE..." disabled>
            <div class="search-results" id="homeSearchResults">
                <div style="padding:10px; text-align:center;" class="blink">PRESS PLAY ON TAPE...</div>
            </div>
        </div>
        
        <h2 style="color: #fff; text-shadow:none;">GAME OF THE MOMENT</h2>
        <div class="monitor-wrapper">
            <div class="monitor-screen" id="spotlightVideo">
                <div style="position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); color:#fff;" class="blink">LOADING SIGNAL...</div>
            </div>
            <div class="monitor-label">COMMODORE 1702 COLOR MONITOR</div>
        </div>

        <h2>QUICK ACCESS: BROWSE GAME SECTIONS</h2>

        <div class="btn-grid">
            <a href="/cheekycommodoregamer.github.io/games" class="btn-retro play-sound btn-emphasise">
                <i class="fa-solid fa-folder-open"></i> BROWSE GENRES
            </a>
            <a href="/cheekycommodoregamer.github.io/games/complete-index.html" class="btn-retro play-sound">
                <i class="fa-solid fa-sort-alpha-down"></i> FULL INDEX
            </a>
            <a href="/cheekycommodoregamer.github.io/resources/quiz.html" class="btn-retro play-sound">
                <i class="fa-solid fa-brain"></i> RETRO QUIZ
            </a>
        </div>
        
        <h2>SUPPORT AND SOCIAL CHANNELS</h2>

        <div class="btn-grid">
             <a href="https://www.youtube.com/@CheekyCommodoreGamer?sub_confirmation=1" target="_blank" class="btn-retro play-sound" style="border-color: var(--c64-red);">
                <i class="fa-brands fa-youtube"></i> SUBSCRIBE
            </a>
             <a href="https://www.paypal.com/donate/?hosted_button_id=LGG86ZV9P4YKL" target="_blank" class="btn-retro play-sound" style="border-color: var(--c64-green);">
                <i class="fa-solid fa-hand-holding-dollar"></i> DONATE
            </a>
        </div>

        <div class="stats-box">
            <span>GAMES: 0</span>
        </div>

    </div>

    <div class="marquee-container" id="marquee">
        <div class="marquee-content">
            *** WELCOME TO CHEEKY COMMODORE GAMER *** UPDATED DAILY WITH NEW C64 & AMIGA TITLES *** CHECK OUT THE NEW QUIZ SECTION *** DON'T FORGET TO SUBSCRIBE ON YOUTUBE *** PRESS PLAY ON TAPE ***
        </div>
    </div>

    <script>
        // ==========================================
        // CONFIGURATION & LOGIC
        // ==========================================
        
        const LOADING_SOUND_URL = "https://raw.githubusercontent.com/joepentony-dot/website-images/main/STAYAWHILE.mp3";
        // FINAL DATA SOURCE: Direct CSV link from your Google Sheet
        const CSV_DATA_URL = "https://docs.google.com/spreadsheets/d/1kUniGNCLsTv4LaoVmcbflhi9Nnky5rCFumzKLI0IA44/gviz/tq?tqx=out:csv"; 

        let allGames = [];
        let loadingAborted = false;

        // --- SOUND EFFECT ---
        function playClickSound() {
            try { 
                const ctx = new (window.AudioContext || window.webkitAudioContext)();
                const o = ctx.createOscillator(), g = ctx.createGain();
                o.connect(g); g.connect(ctx.destination);
                o.type = 'square';
                o.frequency.setValueAtTime(150, ctx.currentTime);
                o.frequency.exponentialRampToValueAtTime(40, ctx.currentTime + 0.1);
                g.gain.setValueAtTime(0.1, ctx.currentTime);
                g.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.1);
                o.start(); o.stop(ctx.currentTime + 0.1);
            } catch(e) {}
        }
        document.querySelectorAll('.play-sound').forEach(el => el.addEventListener('click', playClickSound));

        // --- STARFIELD ---
        const canvas = document.getElementById('starfield');
        const ctx = canvas.getContext('2d');
        let stars = [];
        function resizeCanvas() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; initStars(); }
        function initStars() { stars = []; for(let i=0; i<100; i++) stars.push({ x: Math.random() * canvas.width, y: Math.random() * canvas.height, size: Math.random() * 2, speed: Math.random() * 3 + 0.5 }); }
        function animateStars() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = "#fff";
            stars.forEach(star => {
                ctx.fillRect(star.x, star.y, star.size, star.size);
                star.y += star.speed;
                if(star.y > canvas.height) star.y = 0;
            });
            requestAnimationFrame(animateStars);
        }
        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();
        animateStars();

        // --- TYPEWRITER HELPER ---
        const typeText = (elementId, text, delay = 50) => {
            return new Promise(resolve => {
                if (loadingAborted) { resolve(); return; }
                const el = document.getElementById(elementId);
                // Clear existing content to start fresh typing
                el.innerHTML = ""; 
                let i = 0;
                const timer = setInterval(() => {
                    if (loadingAborted) { clearInterval(timer); resolve(); return; }
                    // Append text without touching the separate cursor element
                    el.innerHTML += text.charAt(i); 
                    i++;
                    if (i >= text.length) {
                        clearInterval(timer);
                        resolve();
                    }
                }, delay);
            });
        };

        // --- TRIGGER START ---
        function startSystem() {
            document.getElementById('start-screen').style.display = 'none';
            document.getElementById('loading-screen').style.display = 'flex';
            load(); 
            
            // NOTE: VISITOR COUNTER IS REMOVED
        }

        // --- SKIP LOADING ---
        function skipLoading() {
            loadingAborted = true;
            document.getElementById('start-screen').style.display = 'none';
            document.getElementById('loading-screen').style.display = 'none';
            document.getElementById('main-container').style.display = 'block';
            document.getElementById('marquee').style.display = 'block';
            document.getElementById("typewriter-text").innerHTML = "COMMODORE 64 & AMIGA: THE ULTIMATE RETRO GAMING DATABASE";
        }

        // --- LOADING SEQUENCE ---
        const runLoadingSequence = async () => {
            const terminal = document.getElementById('loading-terminal');
            const rasterBars = document.getElementById('rasterBars');
            
            if(loadingAborted) return;

            await typeText('loading-terminal', 'LOAD ""');
            await new Promise(r => setTimeout(r, 500));
            if(loadingAborted) return;
            terminal.innerHTML += '<br>';
            
            await new Promise(r => setTimeout(r, 500));
            if(loadingAborted) return;
            terminal.innerHTML += 'PRESS PLAY ON TAPE<br>';
            
            const audio = new Audio(LOADING_SOUND_URL);
            audio.volume = 0.7;
            audio.play().catch(e => console.log("Audio play failed:", e));

            await new Promise(r => setTimeout(r, 1500));
            if(loadingAborted) return;
            
            terminal.innerHTML += 'OK<br>';
            await new Promise(r => setTimeout(r, 800));
            if(loadingAborted) return;
            
            terminal.innerHTML += '<span class="text-highlight">SEARCHING</span><br>';
            await new Promise(r => setTimeout(r, 1000));
            if(loadingAborted) return;
            
            terminal.innerHTML += '<span class="text-highlight">FOUND CHEEKY COMMODORE GAMER</span><br>';
            await new Promise(r => setTimeout(r, 1200));
            if(loadingAborted) return;
            
            terminal.innerHTML += '<span class="text-highlight">LOADING</span><br>';
            if(loadingAborted) return;
            
            rasterBars.style.display = 'block'; 
            
            await new Promise(r => setTimeout(r, 3000)); 
            
            if(!loadingAborted) {
                rasterBars.style.display = 'none'; 
                document.getElementById('loading-screen').style.display = 'none'; 
                document.getElementById('main-container').style.display = 'block'; 
                document.getElementById('marquee').style.display = 'block'; 
                typeText("typewriter-text", "COMMODORE 64 & AMIGA: THE ULTIMATE RETRO GAMING DATABASE", 40);
            }
        };

        // --- DATA FETCHING (Now uses PapaParse for the public CSV) ---
        async function fetchGameData() {
            try {
                // Ensure PapaParse script is loaded first if placed in the footer, but since it's in the head, this is fine.
                const response = await fetch(CSV_DATA_URL);
                const csvText = await response.text();

                return new Promise(resolve => {
                    Papa.parse(csvText, {
                        header: true,
                        skipEmptyLines: true,
                        complete: function(results) {
                            // Extract relevant fields: gametitle, genre, videoid
                            const games = results.data.map(g => ({
                                title: g.gametitle || '',
                                genre: g.genre || '',
                                video: g.videoid || ''
                            })).filter(g => g.title && g.video); // Only keep games with a title and video ID

                            resolve(games);
                        },
                        error: function() {
                            resolve([]);
                        }
                    });
                });
            } catch (e) {
                console.error("Error fetching data from CSV:", e);
                return []; 
            }
        }

        async function load() {
            const searchInput = document.getElementById('homeSearch');
            const loadingEl = document.querySelector('#homeSearchResults div');

            runLoadingSequence();
            
            try {
                allGames = await fetchGameData();
                document.querySelector('.stats-box span:first-child').textContent = `GAMES: ${allGames.length}`; 
                
                searchInput.placeholder = `SEARCH ${allGames.length} TITLES...`;
                searchInput.removeAttribute('disabled');
                loadingEl.textContent = "DATA LOADED OK.";
                setTimeout(() => { document.getElementById('homeSearchResults').classList.remove('active'); }, 1000);

                if(allGames.length > 0) {
                    // Pick a random game to feature
                    const randomGame = allGames[Math.floor(Math.random() * allGames.length)];
                    document.getElementById('spotlightVideo').innerHTML = 
                        `<iframe src="https://www.youtube.com/embed/${randomGame.video}?autoplay=1&mute=1" title="${randomGame.title}" allow="autoplay" frameborder="0" allowfullscreen></iframe>`;
                }

            } catch(e) {
                searchInput.placeholder = "LOAD ERROR.";
                loadingEl.textContent = "?IO ERROR";
            }
        }

        // Search Logic
        const input = document.getElementById('homeSearch');
        const results = document.getElementById('homeSearchResults');

        input.addEventListener('input', () => {
            const q = input.value.toLowerCase().trim();
            results.innerHTML = '';
            if (allGames.length === 0) return;
            if (q.length < 2) { results.classList.remove('active'); return; }
            
            const matches = allGames.filter(g => g.title.toLowerCase().includes(q)).slice(0, 10);
            
            if (!matches.length) {
                results.innerHTML = '<div style="padding:10px; text-align:center;">?FILE NOT FOUND</div>';
            } else {
                const BASE_PATH = "/cheekycommodoregamer.github.io"; // Defined here for local search links
                results.innerHTML = matches.map(g => `
                    <div class="result-item play-sound" onclick="window.open('${g.video ? 'https://www.youtube.com/watch?v='+g.video : BASE_PATH + '/games/complete-index.html'}', '_blank')">
                        <span>${g.title}</span>
                        <span class="result-badge">[${g.genre}]</span>
                    </div>`).join('');
            }
            results.classList.add('active');
        });

        input.addEventListener('keypress', e => { 
            if(e.key === 'Enter' && input.value.trim()) {
                location.href = `/cheekycommodoregamer.github.io/games/complete-index.html?search=${encodeURIComponent(input.value.trim())}`;
            }
        });

        document.addEventListener('click', e => { 
            if(!e.target.closest('.search-wrapper')) results.classList.remove('active'); 
        });

        // Note: We do NOT call load() here anymore. It is called by startSystem() on click.

    </script>
</body>
</html>
