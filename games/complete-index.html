<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cheeky Commodore Gamer - Full Games Index</title>
    <meta name="description" content="Complete A-Z index of Commodore 64 and Amiga games with video reviews. Search, filter by platform, and relive the retro classics.">
    <link rel="canonical" href="https://www.cheekycommodoregamer.co.uk/games/complete-index.html">

    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=VT323&display=swap');
        @import url('https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css');

        :root {
            --c64-blue: #352879;
            --c64-light-blue: #6c5eb5;
            --c64-text: #b8c76f;
            --c64-red: #880000;
            --c64-green: #55cc55;
            --c64-cyan: #00ffff;
            --c64-yellow: #feff6c;
            --c64-purple: #cc44cc;
            --c64-white: #ffffff;
            --c64-black: #000000;
            --c64-orange: #d55e00;
            --c64-brown: #664400;
        }
        * { box-sizing: border-box; }
        body {
            background-color: var(--c64-blue);
            color: var(--c64-text);
            font-family: 'VT323', monospace;
            margin: 0;
            padding: 10px;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            text-transform: uppercase;
            overflow-x: hidden;
        }
        #starfield { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; opacity: 0.3; }
        .crt-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(rgba(18,16,16,0) 50%, rgba(0,0,0,0.25) 50%),
                        linear-gradient(90deg, rgba(255,0,0,0.06), rgba(0,255,0,0.02), rgba(0,0,255,0.06));
            background-size: 100% 2px, 3px 100%;
            pointer-events: none; z-index: 9999;
        }
        #loading-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: var(--c64-blue); z-index: 5000;
            display: flex; flex-direction: column; justify-content: flex-start;
            padding: 40px; font-size: 1.5rem; color: var(--c64-light-blue);
            cursor: default !important;
        }
        #skip-btn {
            position: absolute; top: 10px; right: 10px; z-index: 6002;
            background: var(--c64-red); color: #fff; border: 2px solid #fff;
            padding: 10px 20px; font-family: 'VT323', monospace; font-size: 1.5rem;
            cursor: pointer; text-transform: uppercase; box-shadow: 4px 4px 0px #000;
        }
        #skip-btn:hover { background: #fff; color: var(--c64-red); }
        .raster-bars {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 5001;
            background: linear-gradient(to bottom,
                var(--c64-black) 0%, var(--c64-black) 10%,
                var(--c64-white) 10%, var(--c64-white) 20%,
                var(--c64-red) 20%, var(--c64-red) 30%,
                var(--c64-cyan) 30%, var(--c64-cyan) 40%,
                var(--c64-purple) 40%, var(--c64-purple) 50%,
                var(--c64-green) 50%, var(--c64-green) 60%,
                var(--c64-blue) 60%, var(--c64-blue) 70%,
                var(--c64-yellow) 70%, var(--c64-yellow) 80%,
                var(--c64-orange) 80%, var(--c64-orange) 90%,
                var(--c64-brown) 90%, var(--c64-brown) 100%);
            background-size: 100% 400px;
            animation: rasterScroll 2.5s linear infinite;
            opacity: 0.9; display: none; pointer-events: none; filter: blur(4px);
        }
        @keyframes rasterScroll { 0% { background-position: 0 0; } 100% { background-position: 0 400px; } }
        .loading-text-wrapper { position: relative; z-index: 5002; padding-top: 60px; }
        .text-highlight { background-color: var(--c64-blue); color: var(--c64-light-blue);
            padding: 2px 8px; display: inline-block; box-shadow: 4px 4px 0px rgba(0,0,0,0.5); margin-bottom: 5px; }

        .container {
            width: 100%; max-width: 1000px; border: 4px solid var(--c64-light-blue);
            background-color: rgba(53,40,121,0.95); padding: 15px; position: relative;
            box-shadow: 0 0 20px rgba(0,0,0,0.5); margin: 10px auto 60px;
            display: none;
        }
        h1 { font-size: 2rem; color: #fff; margin: 0 0 10px; text-align: center; }
        h2 { font-size: 1.5rem; color: var(--c64-cyan); margin: 20px 0 10px; text-align: center; text-shadow: 0 0 5px var(--c64-cyan); }
        .commodore-header { text-align: center; margin-bottom: 20px; border-bottom: 2px dashed var(--c64-light-blue); padding-bottom: 10px; }
        .nav-bar { display: flex; justify-content: center; flex-wrap: wrap; gap: 15px; margin-bottom: 15px;
            border-bottom: 2px solid var(--c64-light-blue); padding-bottom: 15px; }
        .nav-link { font-size: 1.2rem; color: var(--c64-text); cursor: pointer; white-space: nowrap; }
        .nav-link:hover { color: #fff; text-decoration: underline; }

        .btn-retro {
            background: var(--c64-light-blue); color: #fff; border: 2px solid #fff;
            padding: 10px 20px; font-family: 'VT323', monospace; font-size: 1.3rem;
            cursor: pointer; text-transform: uppercase; transition: all 0.1s;
        }
        .btn-retro:hover { background: #fff; color: var(--c64-blue); }
        .btn-retro:active { transform: translateY(2px); }

        .search-wrapper { margin: 25px 0; position: relative; }
        .search-input {
            width: 100%; background: #000; color: var(--c64-text); border: 2px solid var(--c64-light-blue);
            padding: 12px; font-family: 'VT323', monospace; font-size: 1.4rem; text-transform: uppercase;
        }
        .search-input:focus { border-color: #fff; }

        .section h2 {
            background: var(--c64-light-blue); color: #fff; padding: 12px; margin: 0;
            cursor: pointer; border: 2px solid #fff; display: flex; justify-content: space-between;
        }
        .games { display: none; background: rgba(0,0,0,0.4); border: 2px solid var(--c64-light-blue); border-top: none; }
        table { width: 100%; border-collapse: collapse; }
        td { padding: 10px; border-bottom: 1px dashed var(--c64-light-blue); color: var(--c64-text); }
        tr:hover td { background: rgba(255,255,255,0.1); }
        .badge { padding: 3px 8px; border: 1px solid; font-size: 0.9rem; margin-right: 8px; }
        .badge-c64 { border-color: var(--c64-red); color: var(--c64-red); }
        .badge-amiga { border-color: var(--c64-green); color: var(--c64-green); }

        .marquee-container {
            position: fixed; bottom: 0; left: 0; width: 100%; background: var(--c64-light-blue);
            color: #fff; padding: 5px 0; border-top: 2px solid #fff; z-index: 100; overflow: hidden;
            white-space: nowrap; display: none;
        }
        .marquee-content { display: inline-block; padding-left: 100%; animation: marquee 25s linear infinite; }
        @keyframes marquee { 0% { transform: translate(0,0); } 100% { transform: translate(-100%,0); } }

        .cursor { display: inline-block; width: 12px; height: 1.1em; background: var(--c64-light-blue); animation: blink 0.8s infinite; }
        @keyframes blink { 0%,100% { opacity: 1; } 50% { opacity: 0; } }

        @media (max-width: 600px) {
            body { padding: 0; }
            .container { padding: 10px 5px; margin-top: 5px; border-width: 2px; }
            .nav-bar { grid-template-columns: repeat(3,1fr); gap: 5px; display: grid; justify-items: center; }
            h1 { font-size: 1.8rem; }
            #loading-screen { padding: 20px; font-size: 1.2rem; }
        }
    </style>
</head>
<body>
    <canvas id="starfield"></canvas>
    <div class="crt-overlay"></div>

    <!-- Same loading screen as homepage -->
    <div id="loading-screen">
        <button id="skip-btn" onclick="skipLoading()">[ ESC ] SKIP LOAD</button>
        <div class="raster-bars" id="rasterBars"></div>
        <div class="loading-text-wrapper">
            <span id="loading-terminal"></span><span class="cursor" id="loading-cursor"></span>
        </div>
    </div>

    <div class="container" id="main-container">
        <div class="commodore-header">
            <img src="https://raw.githubusercontent.com/joepentony-dot/website-images/main/CCGAMER%20LOGO.png" alt="Logo" style="max-width:150px; image-rendering:pixelated;">
            <h3>**** COMMODORE 64 BASIC V2 ****</h3>
            <p>64K RAM SYSTEM 38911 BASIC BYTES FREE</p>
            <div class="nav-bar">
                <a href="/cheekycommodoregamer.github.io/games" class="nav-link play-sound">GENRES</a>
                <a href="/cheekycommodoregamer.github.io/games/complete-index.html" class="nav-link play-sound">INDEX</a>
                <a href="/cheekycommodoregamer.github.io/resources/quiz.html" class="nav-link play-sound">QUIZ</a>
                <a href="/cheekycommodoregamer.github.io/retro-events.html" class="nav-link play-sound">EVENTS</a>
                <a href="/cheekycommodoregamer.github.io/about.html" class="nav-link play-sound">ABOUT</a>
                <a href="/cheekycommodoregamer.github.io/contact.html" class="nav-link play-sound">CONTACT</a>
            </div>
        </div>

        <h1>FULL GAMES INDEX</h1>
        <p style="text-align:center; font-size:1.4rem;">COMMODORE 64 &amp; AMIGA VIDEO CATALOGUE</p>

        <div class="search-wrapper">
            <input type="text" class="search-input" id="searchBox" placeholder="SEARCH TITLES...">
        </div>

        <div style="text-align:center; margin:20px 0; color:var(--c64-cyan);">
            <span id="statsDisplay">GAMES: 0</span>
        </div>

        <div id="playlist-container"></div>
    </div>

    <div class="marquee-container" id="marquee">
        <div class="marquee-content">
            *** CHEEKY COMMODORE GAMER - FULL C64 & AMIGA INDEX *** UPDATED DAILY *** SUBSCRIBE ON YOUTUBE ***
        </div>
    </div>

    <script>
        const CSV_DATA_URL = "https://docs.google.com/spreadsheets/d/1kUniGNCLsTv4LaoVmcbflhi9Nnky5rCFumzKLI0IA44/gviz/tq?tqx=out:csv";
        let allGames = [];
        let loadingAborted = false;

        // Sound
        function playClickSound() {
            try {
                const ctx = new (window.AudioContext || window.webkitAudioContext)();
                const o = ctx.createOscillator(), g = ctx.createGain();
                o.connect(g); g.connect(ctx.destination);
                o.type = 'square';
                o.frequency.setValueAtTime(150, ctx.currentTime);
                o.frequency.exponentialRampToValueAtTime(40, ctx.currentTime + 0.1);
                g.gain.setValueAtTime(0.1, ctx.currentTime);
                g.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.1);
                o.start(); o.stop(ctx.currentTime + 0.1);
            } catch(e) {}
        }
        document.querySelectorAll('.play-sound').forEach(el => el.addEventListener('click', playClickSound));

        // Starfield (same as homepage)
        const canvas = document.getElementById('starfield');
        const ctx = canvas.getContext('2d');
        let stars = [];
        function resizeCanvas() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; initStars(); }
        function initStars() { stars = []; for(let i=0; i<120; i++) stars.push({x:Math.random()*canvas.width, y:Math.random()*canvas.height, size:Math.random()*2, speed:Math.random()*2+0.5}); }
        function animateStars() {
            ctx.clearRect(0,0,canvas.width,canvas.height);
            ctx.fillStyle="#fff";
            stars.forEach(s=>{ctx.fillRect(s.x,s.y,s.size,s.size); s.y+=s.speed; if(s.y>canvas.height) s.y=0;});
            requestAnimationFrame(animateStars);
        }
        window.addEventListener('resize', resizeCanvas);
        resizeCanvas(); animateStars();

        // Typewriter helper
        const typeText = (el, text, delay=50) => new Promise(res => {
            if(loadingAborted) { res(); return; }
            el.innerHTML = ""; let i=0;
            const t=setInterval(()=>{ if(loadingAborted){clearInterval(t);res();return;}
                el.innerHTML += text.charAt(i++); if(i>=text.length){clearInterval(t);res();}
            }, delay);
        });

        function skipLoading() {
            loadingAborted = true;
            document.getElementById('loading-screen').style.display = 'none';
            document.getElementById('main-container').style.display = 'block';
            document.getElementById('marquee').style.display = 'block';
        }

        async function runLoadingSequence() {
            if(loadingAborted) return;
            const term = document.getElementById('loading-terminal');
            await typeText(term, 'LOADING FULL GAMES INDEX'); term.innerHTML += '<br>';
            await new Promise(r=>setTimeout(r,800));
            term.innerHTML += 'SEARCHING...<br>'; await new Promise(r=>setTimeout(r,1000));
            term.innerHTML += '<span class="text-highlight">FOUND CHEEKY COMMODORE GAMER</span><br>';
            await new Promise(r=>setTimeout(r,800));
            term.innerHTML += '<span class="text-highlight">LOADING</span><br>';
            document.getElementById('rasterBars').style.display = 'block';
            await new Promise(r=>setTimeout(r,2500));
            if(!loadingAborted){
                document.getElementById('loading-screen').style.display='none';
                document.getElementById('main-container').style.display='block';
                document.getElementById('marquee').style.display='block';
            }
        }

        async function fetchData() {
            runLoadingSequence();
            try {
                const resp = await fetch(CSV_DATA_URL);
                const text = await resp.text();
                const parsed = Papa.parse(text, {header:true, skipEmptyLines:true});
                allGames = parsed.data.map(g=>({
                    title: g.gametitle || '',
                    video: g.videoid || '',
                    platform: g.lemonlinks?.includes('lemonamiga.com')? 'Amiga' : 'C64',
                    lemon: g.lemonlinks || '',
                    pdf: g.pdflink || '',
                    disk: g.disklinks || '',
                    sortKey: (g.gametitle||'').replace(/^(the|a|an)\s+/i,'').trim().toUpperCase()
                })).filter(g=>g.title && g.video);

                document.getElementById('statsDisplay').textContent = `GAMES: ${allGames.length}`;
                renderGames();
            } catch(e){ console.error(e); }
        }

        function renderGames(query="") {
            const container = document.getElementById('playlist-container');
            container.innerHTML = '';
            let list = allGames;
            if(query) list = list.filter(g=>g.title.toLowerCase().includes(query.toLowerCase()));
            if(list.length===0){
                container.innerHTML = '<p style="text-align:center;color:var(--c64-red);font-size:2rem;">?FILE NOT FOUND</p>';
                return;
            }

            const groups = {};
            list.forEach(g=>{
                const letter = g.sortKey[0].match(/[A-Z]/) ? g.sortKey[0] : '#';
                if(!groups[letter]) groups[letter]=[];
                groups[letter].push(g);
            });

            Object.keys(groups).sort().forEach(letter=>{
                const sec = document.createElement('div'); sec.className='section';
                const h2 = document.createElement('h2');
                h2.innerHTML = `${letter} <span style="font-size:1rem;">[${groups[letter].length}]</span>`;
                h2.onclick = ()=>{ playClickSound(); const div=h2.nextElementSibling; div.style.display = (div.style.display==='block')?'none':'block'; };
                const div = document.createElement('div'); div.className='games';
                const table = document.createElement('table');
                groups[letter].forEach(g=>{
                    const badge = g.platform==='C64'?'badge-c64':'badge-amiga';
                    let links='';
                    if(g.lemon) links+=`<a href="${g.lemon}" target="_blank" class="btn-retro play-sound" style="font-size:0.9rem;padding:5px 10px;">LEMON</a>`;
                    if(g.pdf) links+=`<a href="${g.pdf}" target="_blank" class="btn-retro play-sound" style="font-size:0.9rem;padding:5px 10px;">PDF</a>`;
                    if(g.disk) links+=`<a href="${g.disk}" target="_blank" class="btn-retro play-sound" style="font-size:0.9rem;padding:5px 10px;">DISK</a>`;

                    const tr=document.createElement('tr');
                    tr.innerHTML = `
                        <td style="width:65%;">
                            <span class="badge ${badge}">${g.platform}</span> ${g.title}
                        </td>
                        <td style="width:35%; text-align:right;">
                            <a href="https://www.youtube.com/watch?v=${g.video}" target="_blank" class="btn-retro play-sound" style="font-size:0.9rem;padding:8px 12px;">WATCH</a>
                            ${links}
                        </td>`;
                    table.appendChild(tr);
                });
                div.appendChild(table);
                sec.appendChild(h2); sec.appendChild(div);
                container.appendChild(sec);
            });
        }

        document.getElementById('searchBox').addEventListener('input', e=>renderGames(e.target.value.trim()));

        // Start everything
        window.addEventListener('load', fetchData);
    </script>
</body>
</html>
