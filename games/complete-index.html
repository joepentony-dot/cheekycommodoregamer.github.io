<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cheeky Commodore Gamer - Full Games Index</title>
    <meta name="description" content="Complete A-Z index of Commodore 64 and Amiga games with video reviews. Search and relive the retro classics instantly.">
    <link rel="canonical" href="https://www.cheekycommodoregamer.co.uk/games/complete-index.html">
    
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=VT323&display=swap');
        @import url('https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css');

        :root {
            --c64-blue: #352879;
            --c64-light-blue: #6c5eb5;
            --c64-text: #b8c76f;
            --c64-red: #880000;
            --c64-green: #55cc55;
            --c64-cyan: #00ffff;
            --c64-white: #ffffff;
            --c64-black: #000000;
        }
        * { box-sizing: border-box; margin:0; padding:0; }
        body {
            background-color: var(--c64-blue);
            color: var(--c64-text);
            font-family: 'VT323', monospace;
            margin: 0;
            padding: 10px;
            min-height: 100vh;
            text-transform: uppercase;
            overflow-x: hidden;
            display: flex;
            justify-content: center;
            align-items: flex-start;
        }
        #starfield { position: fixed; top:0; left:0; width:100%; height:100%; z-index:-1; opacity:0.3; }
        .crt-overlay {
            position: fixed; top:0; left:0; width:100%; height:100%;
            background: linear-gradient(rgba(18,16,16,0) 50%, rgba(0,0,0,0.25) 50%),
                        linear-gradient(90deg, rgba(255,0,0,0.06), rgba(0,255,0,0.02), rgba(0,0,255,0.06));
            background-size: 100% 2px, 3px 100%;
            pointer-events: none; z-index: 9999;
        }
        .container {
            width: 100%;
            max-width: 1000px;
            border: 4px solid var(--c64-light-blue);
            background-color: rgba(53,40,121,0.95);
            padding: 15px;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
            margin: 10px auto 60px;
            position: relative;
        }
        .commodore-header {
            text-align: center;
            margin-bottom: 20px;
            border-bottom: 2px dashed var(--c64-light-blue);
            padding-bottom: 10px;
        }
        .nav-bar {
            display: flex; justify-content: center; flex-wrap: wrap; gap: 15px;
            margin-bottom: 15px; border-bottom: 2px solid var(--c64-light-blue); padding-bottom: 15px;
        }
        .nav-link { font-size: 1.2rem; color: var(--c64-text); cursor: pointer; }
        .nav-link:hover { color: #fff; text-decoration: underline; }

        h1 { font-size: 2rem; color: #fff; text-align: center; margin: 10px 0; }
        h2 { font-size: 1.5rem; color: var(--c64-cyan); text-align: center; text-shadow: 0 0 5px var(--c64-cyan); margin: 20px 0 10px; }

        .search-wrapper { margin: 25px 0; position: relative; }
        .search-input {
            width: 100%; background: #000; color: var(--c64-text);
            border: 2px solid var(--c64-light-blue); padding: 12px;
            font-family: 'VT323', monospace; font-size: 1.4rem;
            text-transform: uppercase; outline: none;
        }
        .search-input:focus { border-color: #fff; }

        #statsDisplay { text-align: center; color: var(--c64-cyan); font-size: 1.4rem; margin: 15px 0; }

        .section h2 {
            background: var(--c64-light-blue); color: #fff; padding: 12px; margin: 0;
            cursor: pointer; border: 2px solid #fff;
            display: flex; justify-content: space-between; align-items: center;
        }
        .games { display: none; background: rgba(0,0,0,0.4); border: 2px solid var(--c64-light-blue); border-top: none; }
        table { width: 100%; border-collapse: collapse; }
        td { padding: 10px; border-bottom: 1px dashed var(--c64-light-blue); }
        tr:hover td { background: rgba(255,255,255,0.1); }
        .badge {
            padding: 3px 8px; border: 1px solid; font-size: 0.9rem; margin-right: 8px;
        }
        .badge-c64 { border-color: var(--c64-red); color: var(--c64-red); }
        .badge-amiga { border-color: var(--c64-green); color: var(--c64-green); }

        .btn-retro {
            background: var(--c64-light-blue); color: #fff; border: 2px solid #fff;
            padding: 8px 15px; font-family: 'VT323', monospace; font-size: 1rem;
            cursor: pointer; text-transform: uppercase; text-decoration: none;
            display: inline-block; margin: 2px;
        }
        .btn-retro:hover { background: #fff; color: var(--c64-blue); }

        .marquee-container {
            position: fixed; bottom: 0; left: 0; width: 100%;
            background: var(--c64-light-blue); color: #fff;
            padding: 6px 0; border-top: 2px solid #fff; z-index: 100;
            overflow: hidden; white-space: nowrap;
        }
        .marquee-content {
            display: inline-block; padding-left: 100%;
            animation: marquee 30s linear infinite; font-size: 1.2rem;
        }
        @keyframes marquee { 0% { transform: translate(0,0); } 100% { transform: translate(-100%,0); } }

        @media (max-width: 600px) {
            body { padding: 0; }
            .container { padding: 10px 5px; margin-top: 5px; border-width: 2px; }
            .nav-bar { display: grid; grid-template-columns: repeat(3,1fr); gap: 8px; justify-items: center; }
            h1 { font-size: 1.8rem; }
            .btn-retro { font-size: 0.9rem; padding: 6px 10px; }
        }
    </style>
</head>
<body>
    <canvas id="starfield"></canvas>
    <div class="crt-overlay"></div>

    <div class="container">
        <div class="commodore-header">
            <img src="https://raw.githubusercontent.com/joepentony-dot/website-images/main/CCGAMER%20LOGO.png"
                 alt="Cheeky Commodore Gamer" style="max-width:150px; image-rendering:pixelated; margin:10px 0;">
            <h3>**** COMMODORE 64 BASIC V2 ****</h3>
            <p>64K RAM SYSTEM 38911 BASIC BYTES FREE</p>
            <div class="nav-bar">
                <a href="/cheekycommodoregamer.github.io/games" class="nav-link play-sound">GENRES</a>
                <a href="/cheekycommodoregamer.github.io/games/complete-index.html" class="nav-link play-sound">INDEX</a>
                <a href="/cheekycommodoregamer.github.io/resources/quiz.html" class="nav-link play-sound">QUIZ</a>
                <a href="/cheekycommodoregamer.github.io/retro-events.html" class="nav-link play-sound">EVENTS</a>
                <a href="/cheekycommodoregamer.github.io/about.html" class="nav-link play-sound">ABOUT</a>
                <a href="/cheekycommodoregamer.github.io/contact.html" class="nav-link play-sound">CONTACT</a>
            </div>
        </div>

        <h1>FULL GAMES INDEX</h1>
        <p style="text-align:center; font-size:1.4rem; color:var(--c64-light-blue);">
            COMMODORE 64 &amp; AMIGA VIDEO CATALOGUE
        </p>

        <div class="search-wrapper">
            <input type="text" class="search-input" id="searchBox" placeholder="SEARCH ALL TITLES...">
        </div>

        <div id="statsDisplay">GAMES: LOADING...</div>

        <div id="playlist-container"></div>
    </div>

    <div class="marquee-container">
        <div class="marquee-content">
            *** CHEEKY COMMODORE GAMER - FULL C64 & AMIGA INDEX *** UPDATED DAILY WITH NEW VIDEOS *** SUBSCRIBE ON YOUTUBE FOR MORE RETRO GOODNESS ***
        </div>
    </div>

    <script>
        const CSV_DATA_URL = "https://docs.google.com/spreadsheets/d/1kUniGNCLsTv4LaoVmcbflhi9Nnky5rCFumzKLI0IA44/gviz/tq?tqx=out:csv";
        let allGames = [];

        // Retro SID click sound
        function playClickSound() {
            try {
                const ctx = new (window.AudioContext || window.webkitAudioContext)();
                const o = ctx.createOscillator(), g = ctx.createGain();
                o.connect(g); g.connect(ctx.destination);
                o.type = 'square';
                o.frequency.setValueAtTime(150, ctx.currentTime);
                o.frequency.exponentialRampToValueAtTime(40, ctx.currentTime + 0.1);
                g.gain.setValueAtTime(0.1, ctx.currentTime);
                g.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.1);
                o.start(); o.stop(ctx.currentTime + 0.1);
            } catch(e) {}
        }
        document.querySelectorAll('.play-sound').forEach(el => el.addEventListener('click', playClickSound));

        // Starfield background
        const canvas = document.getElementById('starfield');
        const ctx = canvas.getContext('2d');
        let stars = [];
        function initStars() {
            canvas.width = window.innerWidth; canvas.height = window.innerHeight;
            stars = [];
            for(let i = 0; i < 120; i++) {
                stars.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height,
                    size: Math.random() * 2,
                    speed: Math.random() * 2 + 0.5
                });
            }
        }
        function animateStars() {
            ctx.clearRect(0,0,canvas.width,canvas.height);
            ctx.fillStyle = "#fff";
            stars.forEach(s => {
                ctx.fillRect(s.x, s.y, s.size, s.size);
                s.y += s.speed;
                if(s.y > canvas.height) s.y = 0;
            });
            requestAnimationFrame(animateStars);
        }
        window.addEventListener('resize', initStars);
        initStars(); animateStars();

        // Fetch and render games instantly
        async function loadGames() {
            try {
                const resp = await fetch(CSV_DATA_URL);
                const text = await resp.text();
                const parsed = Papa.parse(text, { header: true, skipEmptyLines: true });

                allGames = parsed.data.map(g => ({
                    title: g.gametitle || '',
                    video: g.videoid || '',
                    platform: g.lemonlinks?.includes('lemonamiga.com') ? 'Amiga' : 'C64',
                    lemon: g.lemonlinks || '',
                    pdf: g.pdflink || '',
                    disk: g.disklinks || '',
                    sortKey: (g.gametitle || '').replace(/^(the|a|an)\s+/i, '').trim().toUpperCase()
                })).filter(g => g.title && g.video);

                document.getElementById('statsDisplay').textContent = `GAMES: ${allGames.length}`;
                renderGames();
            } catch (e) {
                document.getElementById('statsDisplay').textContent = "LOAD ERROR - TRY REFRESH";
                console.error(e);
            }
        }

        function renderGames(query = "") {
            const container = document.getElementById('playlist-container');
            container.innerHTML = '';
            let list = allGames;
            if (query) list = list.filter(g => g.title.toLowerCase().includes(query.toLowerCase()));

            if (list.length === 0) {
                container.innerHTML = '<p style="text-align:center; color:var(--c64-red); font-size:2rem; margin:40px;">?FILE NOT FOUND</p>';
                return;
            }

            const groups = {};
            list.forEach(g => {
                const letter = /[A-Z]/.test(g.sortKey[0]) ? g.sortKey[0] : '#';
                if (!groups[letter]) groups[letter] = [];
                groups[letter].push(g);
            });

            Object.keys(groups).sort().forEach(letter => {
                const sec = document.createElement('div');
                sec.className = 'section';

                const h2 = document.createElement('h2');
                h2.innerHTML = `${letter} <span style="font-size:1rem;">[${groups[letter].length}]</span>`;
                h2.onclick = () => {
                    playClickSound();
                    const div = h2.nextElementSibling;
                    div.style.display = (div.style.display === 'block') ? 'none' : 'block';
                };

                const div = document.createElement('div');
                div.className = 'games';

                const table = document.createElement('table');
                groups[letter].forEach(g => {
                    const badge = g.platform === 'C64' ? 'badge-c64' : 'badge-amiga';
                    let links = '';
                    if (g.lemon) links += `<a href="${g.lemon}" target="_blank" class="btn-retro play-sound">LEMON</a>`;
                    if (g.pdf)   links += `<a href="${g.pdf}"   target="_blank" class="btn-retro play-sound">PDF</a>`;
                    if (g.disk)  links += `<a href="${g.disk}"  target="_blank" class="btn-retro play-sound">DISK</a>`;

                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td style="width:60%;">
                            <span class="badge ${badge}">${g.platform}</span> ${g.title}
                        </td>
                        <td style="width:40%; text-align:right;">
                            <a href="https://www.youtube.com/watch?v=${g.video}" target="_blank" class="btn-retro play-sound">WATCH</a>
                            ${links}
                        </td>`;
                    table.appendChild(tr);
                });

                div.appendChild(table);
                sec.appendChild(h2);
                sec.appendChild(div);
                container.appendChild(sec);
            });
        }

        // Live search
        document.getElementById('searchBox').addEventListener('input', e => renderGames(e.target.value.trim()));

        // Start loading data immediately
        loadGames();
    </script>
</body>
</html>
